<div ng-controller="TenantDetailsCtrl" ng-init="tenantDetailsCtrl.initialize()" layout="column" ng-cloak>
  <md-toolbar class="md-hue-2">
    <div class="md-toolbar-tools">
      <h2 class="md-flex"><i class="fa fa-fw fa-group ng-scope"></i> Tenants</h2>
    </div>
  </md-toolbar>
  <md-content>
    <div flex="80" flex-xs="100" layout="column">
      <div ncy-breadcrumb></div>
    </div>
    <md-tabs md-dynamic-height md-border-bottom>
      <md-tab label="General">
        <md-content class="md-padding">
          <div flex="100" flex-sm="100" flex-xs="100" layout="column">
            <md-card>
              <md-card-title>
                <md-card-title-text>
                  <span class="md-headline">{{ tenantDetailsCtrl.currentTenant.name }}</span>
                </md-card-title-text>
              </md-card-title>
              <md-card-content>
                <form name="tenantForm" class="form-horizontal" ng-submit="tenantDetailsCtrl.onClickSaveButton()"
                      novalidate>
                  <div class="form-group">
                    <label for="key" class="col-sm-3 control-label">Entity key</label>

                    <div class="col-sm-9">
                      <input type="text"
                             class="form-control"
                             style="font-size: 0.8em;"
                             name="key"
                             id="key"
                             readonly
                             ng-model="tenantDetailsCtrl.currentTenant.key">
                    </div>
                  </div>
                  <div class="form-group"
                       ng-class="{ 'has-error' : tenantForm.name.$invalid && !tenantForm.name.$pristine }">
                    <label for="name" class="col-sm-3 control-label">Name</label>

                    <div class="col-sm-4">
                      <input type="text"
                             class="form-control"
                             name="name"
                             id="name"
                             required
                             placeholder="Enter tenant name"
                             ng-model="tenantDetailsCtrl.currentTenant.name"
                             ng-change="tenantDetailsCtrl.autoGenerateTenantCode()"
                             autofocus>
                    </div>
                    <div class="col-sm-5">
                      <p ng-show="tenantForm.name.$invalid && !tenantForm.name.$pristine"
                         class="help-block">
                        The tenant name is required.
                      </p>
                    </div>
                  </div>
                  <div class="form-group"
                       ng-class="{ 'has-error' : tenantForm.tenantCode.$invalid && !tenantForm.tenantCode.$pristine }">
                    <label for="tenantCode" class="col-sm-3 control-label">Tenant
                      code</label>

                    <div class="col-sm-4">
                      <input type="text"
                             class="form-control"
                             name="tenantCode"
                             id="tenantCode"
                             required
                             placeholder="Enter tenant code (must match tenant code in Google Device Management)"
                             ng-model="tenantDetailsCtrl.currentTenant.tenant_code">
                    </div>
                    <div class="col-sm-5">
                      <p ng-show="tenantForm.tenantCode.$invalid && !tenantForm.tenantCode.$pristine"
                         class="help-block">
                        The tenant lookup code is required.
                      </p>
                    </div>
                  </div>
                  <div class="form-group"
                       ng-class="{ 'has-error' : tenantForm.adminEmail.$invalid && !tenantForm.adminEmail.$pristine }">
                    <label for="adminEmail" class="col-sm-3 control-label">Admin email
                      address</label>

                    <div class="col-sm-4">
                      <input type="text"
                             required
                             class="form-control"
                             name="adminEmail"
                             id="adminEmail"
                             placeholder="Enter admin email"
                             ng-model="tenantDetailsCtrl.currentTenant.admin_email">
                    </div>
                    <div class="col-sm-5">
                      <p ng-show="tenantForm.adminEmail.$invalid && !tenantForm.adminEmail.$pristine"
                         class="help-block">
                        The tenant admin email address is required.
                      </p>
                    </div>
                  </div>
                  <div class="form-group"
                       ng-class="{ 'has-error' : tenantForm.chromeDeviceDomain.$invalid && !tenantForm.chromeDeviceDomain.$pristine }">
                    <label for="chromeDeviceDomain" class="col-sm-3 control-label">Device domain</label>

                    <div class="col-sm-4">
                      <select id="chromeDeviceDomain"
                              ng-model="tenantDetailsCtrl.selectedDomain"
                              class="form-control"
                              ng-options="i.name for i in tenantDetailsCtrl.distributorDomains track by i.key">
                        <option value=''>Select domain</option>
                      </select>
                    </div>
                    <div class="col-sm-5">
                      <p ng-show="tenantForm.chromeDeviceDomain.$invalid && !tenantForm.chromeDeviceDomain.$pristine"
                         class="help-block">
                        The Device domain is required.
                      </p>
                    </div>
                  </div>
                  <div class="form-group"
                       ng-class="{ 'has-error' : tenantForm.contentManagerBaseUrl.$invalid && !tenantForm.contentManagerBaseUrl.$pristine }">
                    <label for="contentManagerBaseUrl" class="col-sm-3 control-label">
                      Content manager base URL
                    </label>

                    <div class="col-sm-4">
                      <input type="url"
                             required
                             class="form-control"
                             name="contentManagerBaseUrl"
                             id="contentManagerBaseUrl"
                             placeholder="Enter content manager base URL"
                             ng-model="tenantDetailsCtrl.currentTenant.content_manager_base_url"
                             ng-pattern="/^https:\/\/\S+$/">
                    </div>
                    <div class="col-sm-5">
                      <p
                        ng-show="tenantForm.contentManagerBaseUrl.$invalid && !tenantForm.contentManagerBaseUrl.$pristine"
                        class="help-block">
                        The content manager base URL is required to be a secure URL.
                      </p>
                    </div>
                  </div>
                  <div class="form-group"
                       ng-class="{ 'has-error' : tenantForm.contentServerUrl.$invalid && !tenantForm.contentServerUrl.$pristine }">
                    <label for="contentServerUrl" class="col-sm-3 control-label">Content
                      server URL</label>

                    <div class="col-sm-4">
                      <input type="url"
                             required
                             class="form-control"
                             name="contentServerUrl"
                             id="contentServerUrl"
                             placeholder="Enter content server URL"
                             ng-model="tenantDetailsCtrl.currentTenant.content_server_url"
                             ng-pattern="/^https:\/\/\S+$/">
                    </div>
                    <div class="col-sm-5">
                      <p ng-show="tenantForm.contentServerUrl.$invalid && !tenantForm.contentServerUrl.$pristine"
                         class="help-block">
                        The content server URL is required to be a secure URL.
                      </p>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="notificationEmails" class="col-sm-3 control-label">Notification Emails</label>
                    <div class="col-sm-4">
                      <input type="text"
                             class="form-control"
                             name="notificationEmails"
                             id="notificationEmails"
                             placeholder="Enter comma-delimited emails"
                             ng-model="tenantDetailsCtrl.currentTenant.notification_emails">
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="col-sm-offset-3 col-sm-9">
                      <input type="checkbox"
                             id="active"
                             ng-model="tenantDetailsCtrl.currentTenant.active"> <label
                      for="active">Active</label>
                    </div>
                  </div>
                  <md-card-actions layout="row" layout-align="end center">
                    <md-button type="submit" ng-disabled="tenantForm.$invalid">
                      <i class="fa fa-fw fa-save"></i> Save
                    </md-button>
                  </md-card-actions>
                </form>
              </md-card-content>
            </md-card>
          </div>
        </md-content>
      </md-tab>
      <md-tab label="Managed devices">
        <md-content class="md-padding">
          <div flex="100" flex-sm="100" flex-xs="100" layout="column">
            <md-card>
              <md-card-title>
                <md-card-title-text>
                  <span class="md-headline">{{ tenantDetailsCtrl.currentTenant.name }}</span>
                </md-card-title-text>
              </md-card-title>
              <md-card-content>
                <table class="table table-condensed table-responsive table-striped">
                  <thead>
                  <tr>
                    <th></th>
                    <th><i class="fa fa-fw fa-wifi"></i> MAC</th>
                    <th><i class="fa fa-fw fa-plug"></i> MAC</th>
                    <th>Serial number</th>
                    <th>Provisioned</th>
                    <th></th>
                    <th></th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr ng-hide="tenantDetailsCtrl.currentTenantDisplays.length">
                    <td colspan="7" class="text-center text-danger">No displays</td>
                  </tr>
                  <tr ng-repeat="item in tenantDetailsCtrl.currentTenantDisplays | orderBy:'-created' ">
                    <td>
                      <a class="btn" ng-click="tenantDetailsCtrl.editItem(item)"
                         title="Device detail">
                        <ng-md-icon icon="mode_edit" size="48"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"></path><path d="M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></svg></ng-md-icon>
                      </a>
                    </td>
                    <td>{{ item.macAddress }}</td>
                    <td>{{ item.ethernetMacAddress }}</td>
                    <td>
                      <a name="edit-device" class="btn" ng-click="tenantDetailsCtrl.editItem(item)"
                         title="Device detail">{{item.serialNumber}}</a>
                    </td>
                    <td>{{ item.created }}</td>
                    <td>
                      <md-button class="md-secondary"
                                 ng-click="tenantDetailsCtrl.showDeviceDetails(item, $event)">More Info</md-button>
                    </td>
                    <td class="up-{{ item.up}}-background"></td>
                  </tr>
                  </tbody>
                </table>
              </md-card-content>
            </md-card>
          </div>
        </md-content>
      </md-tab>
      <md-tab label="Unmanaged devices">
        <md-content class="md-padding">
          <div flex="100" flex-sm="100" flex-xs="100" layout="column">
            <md-card>
              <md-card-title>
                <md-card-title-text>
                  <span class="md-headline">{{ tenantDetailsCtrl.currentTenant.name }}</span>
                </md-card-title-text>
              </md-card-title>
              <md-card-content>
                <table class="table table-condensed table-responsive table-striped">
                  <thead>
                  <tr>
                    <th></th>
                    <th><i class="fa fa-fw fa-wifi"></i> MAC</th>
                    <th><i class="fa fa-fw fa-plug"></i> MAC</th>
                    <th>Provisioned</th>
                    <th></th>
                    <th></th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr ng-hide="tenantDetailsCtrl.currentTenantUnmanagedDisplays.length">
                    <td colspan="6" class="text-center text-danger">No displays</td>
                  </tr>
                  <tr ng-repeat="item in tenantDetailsCtrl.currentTenantUnmanagedDisplays | orderBy:'-created' ">
                    <td>
                      <a class="btn" ng-click="tenantDetailsCtrl.editItem(item)"
                         title="Device detail">
                        <ng-md-icon icon="mode_edit" size="48"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"></path><path d="M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></svg></ng-md-icon>
                      </a>
                    </td>
                    <td>{{ item.macAddress }}</td>
                    <td>{{ item.ethernetMacAddress }}</td>
                    <td>{{ item.created }}</td>
                    <td>
                      <md-button class="md-secondary"
                                 ng-click="tenantDetailsCtrl.showDeviceDetails(item, $event)">More Info</md-button>
                    </td>
                    <td class="up-{{ item.up}}-background"></td>
                  </tr>
                  </tbody>
                </table>

              </md-card-content>
            </md-card>
          </div>
        </md-content>
      </md-tab>
    </md-tabs>
  </md-content>
</div>
